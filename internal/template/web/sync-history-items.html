{{if eq (len .Items) 0}}
<div class="empty-state">
    <div class="empty-state-icon">
        <iconify-icon icon="mdi:history"></iconify-icon>
    </div>
    <div class="empty-state-content">
        <h3>{{call .T "history.no_history"}}</h3>
        <p>{{call .T "history.no_history_description"}}</p>
    </div>
</div>
{{else}}
{{range .Items}}
<div class="history-item" data-storage-id="{{.StorageID}}" data-status="{{.Status}}">
    <div class="history-header">
        <div class="history-info">
            <h3>
                {{if eq .Type "webdav"}}
                    <iconify-icon icon="mdi:cloud-upload" class="type-icon"></iconify-icon>
                {{else if eq .Type "s3"}}
                    <iconify-icon icon="mdi:aws" class="type-icon"></iconify-icon>
                {{else}}
                    <iconify-icon icon="mdi:sync" class="type-icon"></iconify-icon>
                {{end}}
                {{.StorageName}}
            </h3>
            <div class="history-meta">
                <span><iconify-icon icon="mdi:clock"></iconify-icon>{{.StartTime}}</span>
                {{if .Duration}}
                <span><iconify-icon icon="mdi:timer"></iconify-icon>{{.Duration}}</span>
                {{end}}
            </div>
        </div>
        <div class="history-status status-{{.Status}}">
            {{if eq .Status "success"}}
                <iconify-icon icon="mdi:check-circle"></iconify-icon>
                {{call .T "history.success"}}
            {{else if eq .Status "error"}}
                <iconify-icon icon="mdi:alert-circle"></iconify-icon>
                {{call .T "history.error"}}
            {{else if eq .Status "running"}}
                <iconify-icon icon="mdi:loading" class="spinning"></iconify-icon>
                {{call .T "history.running"}}
            {{end}}
        </div>
    </div>
    
    <div class="history-details">
        {{if .BackupSize}}
        <div class="detail-row">
            <span class="detail-label">{{call .T "history.backup_size"}}:</span>
            <span class="detail-value">{{.BackupSize}}</span>
        </div>
        {{end}}
        {{if .FileCount}}
        <div class="detail-row">
            <span class="detail-label">{{call .T "history.files_backed_up"}}:</span>
            <span class="detail-value">{{.FileCount}}</span>
        </div>
        {{end}}
        {{if .CompressedSize}}
        <div class="detail-row">
            <span class="detail-label">{{call .T "history.compressed_size"}}:</span>
            <span class="detail-value">{{.CompressedSize}}</span>
        </div>
        {{end}}
        {{if .UploadSpeed}}
        <div class="detail-row">
            <span class="detail-label">{{call .T "history.upload_speed"}}:</span>
            <span class="detail-value">{{.UploadSpeed}}</span>
        </div>
        {{end}}
        {{if .BackupPath}}
        <div class="detail-row">
            <span class="detail-label">{{call .T "history.backup_path"}}:</span>
            <span class="detail-value">{{.BackupPath}}</span>
        </div>
        {{end}}
    </div>
    
    {{if .Error}}
    <div class="error-message">
        <iconify-icon icon="mdi:alert-circle"></iconify-icon>
        {{.Error}}
    </div>
    {{end}}
</div>
{{end}}
{{end}}

<style>
@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

.spinning {
    animation: spin 1s linear infinite;
}

.empty-state {
    text-align: center;
    padding: 3rem;
    color: var(--pico-muted-color);
}

.empty-state-icon {
    font-size: 4rem;
    margin-bottom: 1rem;
    opacity: 0.5;
}

.empty-state-content h3 {
    margin-bottom: 0.5rem;
    color: var(--pico-color);
}
</style>