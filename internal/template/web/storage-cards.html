{{if eq (len .Cards) 0}}
<div class="empty-state">
    <div class="empty-state-icon">
        <iconify-icon icon="mdi:database-off-outline"></iconify-icon>
    </div>
    <div class="empty-state-content">
        <h3>{{call $.T "storage.no_backends"}}</h3>
        <p>{{call $.T "storage.add_new_description"}}</p>
        <div class="empty-state-actions">
            <button onclick="document.getElementById('storage_type').focus()" class="btn btn-primary">
                <iconify-icon icon="mdi:plus"></iconify-icon>
                {{call $.T "storage.add_backend"}}
            </button>
        </div>
    </div>
    </div>
{{else}}
{{range .Cards}}
<div class="storage-card" data-status="{{if eq .Status "Enabled"}}enabled{{else}}disabled{{end}}">
    <div class="storage-card-header">
        <div class="storage-info">
            <div class="storage-icon">
                {{if eq .Type "webdav"}}
                    <iconify-icon icon="mdi:cloud-upload" class="type-icon webdav"></iconify-icon>
                {{else if eq .Type "s3"}}
                    <iconify-icon icon="mdi:aws" class="type-icon s3"></iconify-icon>
                {{end}}
            </div>
            <div class="storage-details">
                <h3 class="storage-name">{{.Name}}</h3>
                <div class="storage-meta">
                    <span class="storage-type">{{.Type}}</span>
                    <span class="storage-status status-{{if eq .Status "Enabled"}}enabled{{else}}disabled{{end}}">
                        {{if eq .Status "Enabled"}}
                            <iconify-icon icon="mdi:check-circle"></iconify-icon>
                            {{call $.T "storage.enabled"}}
                        {{else}}
                            <iconify-icon icon="mdi:pause-circle"></iconify-icon>
                            {{call $.T "storage.disabled"}}
                        {{end}}
                    </span>
                </div>
            </div>
        </div>
        <div class="storage-actions">
            <div class="action-buttons">
                <button hx-post="/api/sync/{{.ID}}" hx-target="#global-notifications" hx-swap="afterbegin" 
                        class="btn btn-action btn-primary" title="{{call $.T "storage.sync_now"}}"
                        {{if ne .Status "Enabled"}}disabled{{end}}>
                    <iconify-icon icon="mdi:sync"></iconify-icon>
                    <span class="btn-text">{{call $.T "common.sync"}}</span>
                </button>
                <button hx-get="/storage/{{.ID}}/edit" hx-target="body" 
                        class="btn btn-action btn-secondary" title="{{call $.T "storage.edit"}}">
                    <iconify-icon icon="mdi:pencil"></iconify-icon>
                    <span class="btn-text">{{call $.T "common.edit"}}</span>
                </button>
                <button hx-delete="/api/storage/{{.ID}}" hx-target="#storage-list" hx-swap="innerHTML"
                        hx-confirm="{{call $.T "storage.delete_confirm"}}"
                        class="btn btn-action btn-danger" title="{{call $.T "common.delete"}}">
                    <iconify-icon icon="mdi:delete"></iconify-icon>
                    <span class="btn-text">{{call $.T "common.delete"}}</span>
                </button>
            </div>
        </div>
    </div>
    
    <div class="storage-card-body">
        {{if .Config}}
            <div class="config-info">
                {{if eq .Type "webdav"}}
                    <div class="config-item">
                        <iconify-icon icon="mdi:server" class="config-icon"></iconify-icon>
                        <span class="config-label">{{call $.T "storage.webdav.url"}}:</span>
                        <span class="config-value">{{.Config.url}}</span>
                    </div>
                {{else if eq .Type "s3"}}
                    <div class="config-item">
                        <iconify-icon icon="mdi:server" class="config-icon"></iconify-icon>
                        <span class="config-label">{{call $.T "storage.s3.endpoint"}}:</span>
                        <span class="config-value">{{if .Config.endpoint}}{{.Config.endpoint}}{{else}}AWS S3{{end}}</span>
                    </div>
                    <div class="config-item">
                        <iconify-icon icon="mdi:earth" class="config-icon"></iconify-icon>
                        <span class="config-label">{{call $.T "storage.s3.region"}}:</span>
                        <span class="config-value">{{.Config.region}}</span>
                    </div>
                    <div class="config-item">
                        <iconify-icon icon="mdi:bucket" class="config-icon"></iconify-icon>
                        <span class="config-label">{{call $.T "storage.s3.bucket"}}:</span>
                        <span class="config-value">{{.Config.bucket}}</span>
                    </div>
                {{end}}
            </div>
        {{end}}
        
        <div class="sync-status-section">
            <div class="sync-status-item">
                <div class="status-indicator status-{{.SyncStatusClass}}">
                    <iconify-icon icon="{{.SyncStatusIcon}}"></iconify-icon>
                </div>
                <div class="status-content">
                    <div class="status-text">{{.LastSyncStatus}}</div>
                    <div class="status-time">{{printf (call $.T "dashboard.last_sync") .LastSync}}</div>
                    {{if .SyncError}}
                    <div class="status-error">
                        <iconify-icon icon="mdi:alert-circle"></iconify-icon>
                        {{.SyncError}}
                    </div>
                    {{end}}
                </div>
            </div>
        </div>
    </div>
    
    <div class="storage-card-footer">
        <div class="storage-stats">
            <div class="stat-item">
                <iconify-icon icon="mdi:calendar-plus" class="stat-icon"></iconify-icon>
                <span class="stat-label">{{call $.T "common.created"}}:</span>
                <span class="stat-value">{{.Created}}</span>
            </div>
        </div>
    </div>
</div>
{{end}}
{{end}}
