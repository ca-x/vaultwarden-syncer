<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>{{.Title}} - Vaultwarden Syncer</title>
    <link rel="stylesheet" href="https://unpkg.com/@picocss/pico@latest/css/pico.min.css">
    <link rel="stylesheet" href="/static/styles.css">
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
</head>
<body{{if .AuthLayout}} class="auth-layout"{{end}}>
    {{if .ShowNav}}
    <nav>
        <ul>
            <li><strong class="brand-logo"><iconify-icon icon="mdi:shield-lock"></iconify-icon>Vaultwarden Syncer</strong></li>
        </ul>
        <ul>
            {{range .NavItems}}
            <li><a href="{{.URL}}">{{.Icon}} {{.Text}}</a></li>
            {{end}}
            <li>
                <button id="theme-toggle" class="theme-toggle-btn">
                    <!-- Theme icon -->
                    {{icon "theme-light"}}
                </button>
            </li>
        </ul>
    </nav>
    {{end}}
    
    <!-- Global Notification Container -->
    <div id="global-notifications" class="notification-container"></div>
    
    <main class="container{{if .AuthLayout}} glass-card auth-container{{end}}">
        {{if .Message}}
        <div class="message message-{{.Message.Type}}" style="margin-bottom: 2rem;">
            {{.Message.Icon}}
            <span>{{.Message.Content}}</span>
        </div>
        {{end}}
        {{.Content}}
    </main>
    
    <script>
        // Theme toggle functionality
        document.addEventListener('DOMContentLoaded', function() {
            const themeToggle = document.getElementById('theme-toggle');
            const htmlElement = document.documentElement;
            
            // Only initialize if elements exist (in case we're on a page without nav)
            if (themeToggle) {
                // Check for saved theme or default to light
                const savedTheme = localStorage.getItem('theme') || 'light';
                setTheme(savedTheme);
                
                // Toggle theme on button click
                themeToggle.addEventListener('click', function() {
                    const currentTheme = htmlElement.getAttribute('data-theme');
                    const newTheme = currentTheme === 'light' ? 'dark' : 'light';
                    setTheme(newTheme);
                });
                
                function setTheme(theme) {
                    htmlElement.setAttribute('data-theme', theme);
                    localStorage.setItem('theme', theme);
                }
            }
        });
        
        // Global Notification System
        window.showNotification = function(message, type = 'info', duration = 5000) {
            const container = document.getElementById('global-notifications');
            if (!container) return;
            
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            
            const icons = {
                success: 'mdi:check-circle',
                error: 'mdi:alert-circle',
                warning: 'mdi:alert',
                info: 'mdi:information'
            };
            
            notification.innerHTML = `
                <div class="notification-content">
                    <iconify-icon icon="${icons[type] || icons.info}"></iconify-icon>
                    <span class="notification-message">${message}</span>
                </div>
                <button class="notification-close" onclick="this.parentElement.remove()">Ã—</button>
            `;
            
            // Add to container
            container.appendChild(notification);
            
            // Animate in
            requestAnimationFrame(() => {
                notification.classList.add('notification-show');
            });
            
            // Auto-close after duration
            setTimeout(() => {
                notification.classList.add('notification-hide');
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.remove();
                    }
                }, 300);
            }, duration);
        };
    </script>
</body>
</html>
